Структура данных "Декартово дерево поиска" была рассмотренна на лекции. Для нахождения next(i) сплитуем дерево на два таких, что в правом находятся все узлы, ключи которых > i, а в левом <=, далее в правом поддереве ищем минимальный ключ, спускаясь всегда влево до листа дерева, его ключ будет ответом. С previous симметрично.
Для нахождения порядковой статистики поддерживаем размер каждого поддерева. Если номер порядковой статистики меньше или равен, чем вразмер левого поддерева(количество узлов < текущего узла), то идём влево, если размер левого поддерева на один меньше номера порядковой статистики, то мы нашли нужный узел, иначе идём вправо и уменьшаем порядковую статистику на размер левого поддерева и единицу(возникает из-за того, что текущий узел тоже не подходит).
