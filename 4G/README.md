Используем декартовое дерево по неявному ключу с поддержанием минимума на поддереве(отрезке). Разворот отрезка - разворот всех поддеревьев на отрезка. Реализуем с помощью проталкивания несогласованности. 
